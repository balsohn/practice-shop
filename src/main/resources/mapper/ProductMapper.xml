<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.shop.mapper.ProductMapper">
	<select id="list" resultType="kr.co.shop.dto.ProductDTO">
		select * from product where 
		pcode like concat(#{pcode},'%')
		order by ${order} limit #{index},20
	</select>
	<select id="getDaeName" resultType="string">
		select name from dae
		where code=#{code}
	</select>
	<select id="getJungName" resultType="string">
		select name from jung
		where code=#{code} and daecode=#{daecode}
	</select>
	<select id="getSoName" resultType="string">
		select name from so
		where code=#{code} and daejung=#{daejung}
	</select>
	<select id="getChong" resultType="int">
		select ceil(count(*)/20) from product where pcode like
		concat(#{pcode},'%')
	</select>
	<select id="content" resultType="kr.co.shop.dto.ProductDTO">
		select * from product where pcode=#{pcode}
	</select>
	<insert id="jjimOk">
		insert into jjim (userid,pcode,writeday)
		values (#{userid},#{pcode},now())
	</insert>
	<delete id="jjimDel">
		delete from jjim where pcode=#{pcode} and userid=#{userid}
	</delete>
	<select id="jjimChk" resultType="int">
		select count(*) from jjim where pcode=#{pcode} and userid=#{userid}
	</select>
	<insert id="addCart">
		insert into cart (userid, pcode, su, writeday)
		values (#{userid},#{pcode},#{su},now())
	</insert>
	<select id="isCart" resultType="Boolean">
		select count(*) from cart 
		where userid=#{userid} and pcode=#{pcode} 
	</select>
	<update id="upCart">
		update cart set su=su+#{su}
		where userid=#{userid} and pcode=#{pcode}
	</update>
</mapper>